# AI ν”λ μ΄μ–΄ μ¶”κ°€ κΈ°λ¥ κµ¬ν„ μ μ•

**μ‘μ„±μΌ**: 2025-12-12  
**μ‘μ„±μ**: ν”„λ΅ νΈμ—”λ“ λ‹΄λ‹Ήμ  
**λ€μƒ**: λ°±μ—”λ“ λ‹΄λ‹Ήμ

---

## π“‹ κ°μ”

ν”„λ΅ νΈμ—”λ“μ—μ„ AI ν”λ μ΄μ–΄ μ¶”κ°€ κΈ°λ¥μ„ κµ¬ν„ν•κΈ° μ„ν•΄ λ°±μ—”λ“ ν”„λ΅ν† μ½ μ •μκ°€ ν•„μ”ν•©λ‹λ‹¤.  
μ΄ λ¬Έμ„λ” κ°€μ¥ μ•μ •μ μ΄κ³  ν™•μ¥ κ°€λ¥ν• λ°©λ²•μ„ μ μ•ν•©λ‹λ‹¤.

---

## π― μ μ•ν•λ” λ°©λ²•: λ³„λ„ λ©”μ‹μ§€ λ°©μ‹ (ADD_AI_PLAYER)

### μ΄μ 
1. **λ…ν™•μ„±**: URL μΏΌλ¦¬ νλΌλ―Έν„°λ³΄λ‹¤ λ…ν™•ν•κ³  κµ¬μ΅°ν™”λ λ°μ΄ν„° μ „μ†΅
2. **ν™•μ¥μ„±**: ν–¥ν›„ AI ν”λ μ΄μ–΄ κ΄€λ ¨ μ¶”κ°€ κΈ°λ¥ ν™•μ¥ μ©μ΄
3. **μ μ—°μ„±**: λ΅λΉ„ μ—°κ²° ν›„μ—λ„ AI ν”λ μ΄μ–΄ μ¶”κ°€/μ κ±° κ°€λ¥
4. **μ•μ •μ„±**: URL κΈΈμ΄ μ ν• μ—†μ, λ³µμ΅ν• μµμ… μ „λ‹¬ κ°€λ¥
5. **ν‘μ¤€μ„±**: λ‹¤λ¥Έ κ²μ„ μ•΅μ…κ³Ό μΌκ΄€λ λ©”μ‹μ§€ ν•μ‹

---

## π“¨ λ©”μ‹μ§€ ν”„λ΅ν† μ½ μ μ•

### 1. AI ν”λ μ΄μ–΄ μ¶”κ°€ μ”μ²­ (ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„)

```json
{
  "type": "ADD_AI_PLAYER",
  "game_id": "game_12345",  // optional, ν„μ¬ μ—°κ²°λ κ²μ„μ΄λ©΄ μƒλµ κ°€λ¥
  "count": 3,                // μ¶”κ°€ν•  AI ν”λ μ΄μ–΄ μ (1-7)
  "difficulty": "medium"     // "easy" | "medium" | "hard"
}
```

**μ‘λ‹µ**: `ACTION_RESPONSE` λ©”μ‹μ§€

**μ„±κ³µ μ‘λ‹µ**:
```json
{
  "type": "ACTION_RESPONSE",
  "data": {
    "success": true,
    "message": "AI ν”λ μ΄μ–΄ 3λ…μ΄ μ¶”κ°€λμ—μµλ‹λ‹¤.",
    "game_id": "game_12345"
  }
}
```

**μ‹¤ν¨ μ‘λ‹µ**:
```json
{
  "type": "ACTION_RESPONSE",
  "data": {
    "success": false,
    "message": "μµλ€ ν”λ μ΄μ–΄ μλ¥Ό μ΄κ³Όν–μµλ‹λ‹¤. (ν„μ¬: 4λ…, μµλ€: 7λ…)"
  }
}
```

**λλ” ERROR λ©”μ‹μ§€**:
```json
{
  "type": "ERROR",
  "message": "μµλ€ ν”λ μ΄μ–΄ μλ¥Ό μ΄κ³Όν–μµλ‹λ‹¤.",
  "code": "MAX_PLAYERS_EXCEEDED"
}
```

### 2. AI ν”λ μ΄μ–΄ μ κ±° μ”μ²­ (μ„ νƒμ‚¬ν•­, ν–¥ν›„ ν™•μ¥μ©)

```json
{
  "type": "REMOVE_AI_PLAYER",
  "game_id": "game_12345",  // optional
  "count": 1                 // μ κ±°ν•  AI ν”λ μ΄μ–΄ μ
}
```

### 3. κ²μ„ μƒνƒ μ—…λ°μ΄νΈ (μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ)

AI ν”λ μ΄μ–΄ μ¶”κ°€ ν›„ μλ™μΌλ΅ `GAME_STATE_UPDATE` λ©”μ‹μ§€κ°€ μ „μ†΅λμ–΄μ•Ό ν•©λ‹λ‹¤:

```json
{
  "type": "GAME_STATE_UPDATE",
  "gameId": "game_12345",
  "players": [
    {
      "id": "player_001",
      "name": "ν™κΈΈλ™",
      "hp": 4,
      "influence": 0,
      "role": null,
      "hand": [...],
      "handCount": 2,
      "tableCards": [],
      "treasures": [],
      "isAlive": true,
      "position": 0,
      "isBot": false  // π‘ AI ν”λ μ΄μ–΄ κµ¬λ¶„ ν•„λ“
    },
    {
      "id": "player_002",
      "name": "AI_Player_1",
      "hp": 4,
      "influence": 0,
      "role": null,
      "hand": null,  // AI ν”λ μ΄μ–΄μ ν•Έλ“λ” null
      "handCount": 2,
      "tableCards": [],
      "treasures": [],
      "isAlive": true,
      "position": 1,
      "isBot": true  // π‘ AI ν”λ μ΄μ–΄ ν‘μ‹
    }
  ],
  "phase": "lobby"
}
```

---

## π”„ λ©”μ‹μ§€ νλ¦„

### μ‹λ‚λ¦¬μ¤ 1: λ°© μƒμ„± μ‹ AI ν”λ μ΄μ–΄ μ¶”κ°€

1. **ν΄λΌμ΄μ–ΈνΈ**: WebSocket μ—°κ²° (`ws://localhost:8080/lobby/{gameId}?player={playerName}`)
2. **μ„λ²„**: `CONNECTION_ESTABLISHED` λ©”μ‹μ§€ μ „μ†΅
3. **μ„λ²„**: `GAME_STATE_UPDATE` λ©”μ‹μ§€ μ „μ†΅ (ν„μ¬ ν”λ μ΄μ–΄λ§ ν¬ν•¨)
4. **ν΄λΌμ΄μ–ΈνΈ**: `ADD_AI_PLAYER` λ©”μ‹μ§€ μ „μ†΅
   ```json
   {
     "type": "ADD_AI_PLAYER",
     "count": 3,
     "difficulty": "medium"
   }
   ```
5. **μ„λ²„**: AI ν”λ μ΄μ–΄ μƒμ„± λ° κ²μ„ μƒνƒ μ—…λ°μ΄νΈ
6. **μ„λ²„**: `ACTION_RESPONSE` λ©”μ‹μ§€ μ „μ†΅ (μ„±κ³µ/μ‹¤ν¨)
7. **μ„λ²„**: `GAME_STATE_UPDATE` λ©”μ‹μ§€ λΈλ΅λ“μΊμ¤νΈ (λ¨λ“  ν”λ μ΄μ–΄μ—κ², AI ν¬ν•¨)

### μ‹λ‚λ¦¬μ¤ 2: λ΅λΉ„μ—μ„ AI ν”λ μ΄μ–΄ μ¶”κ°€

1. **ν΄λΌμ΄μ–ΈνΈ**: μ΄λ―Έ λ΅λΉ„μ— μ—°κ²°λ μƒνƒ
2. **ν΄λΌμ΄μ–ΈνΈ**: `ADD_AI_PLAYER` λ©”μ‹μ§€ μ „μ†΅
3. **μ„λ²„**: AI ν”λ μ΄μ–΄ μƒμ„± λ° κ²μ„ μƒνƒ μ—…λ°μ΄νΈ
4. **μ„λ²„**: `ACTION_RESPONSE` λ©”μ‹μ§€ μ „μ†΅
5. **μ„λ²„**: `GAME_STATE_UPDATE` λ©”μ‹μ§€ λΈλ΅λ“μΊμ¤νΈ

---

## β… κ²€μ¦ κ·μΉ™ μ μ•

### AI ν”λ μ΄μ–΄ μ¶”κ°€ μ‹ κ²€μ¦
1. **μµλ€ ν”λ μ΄μ–΄ μ ν™•μΈ**: ν„μ¬ ν”λ μ΄μ–΄ μ + μ¶”κ°€ν•  AI μ β‰¤ μµλ€ ν”λ μ΄μ–΄ μ (7λ…)
2. **μµμ† ν”λ μ΄μ–΄ μ ν™•μΈ**: κ²μ„ μ‹μ‘ μ‹ μµμ† 4λ… ν•„μ”
3. **κ²μ„ μƒνƒ ν™•μΈ**: `phase`κ°€ `"lobby"`μΌ λ•λ§ μ¶”κ°€ κ°€λ¥
4. **AI ν”λ μ΄μ–΄ μ μ ν•**: ν• λ²μ— μµλ€ 7λ…κΉμ§€ μ¶”κ°€ κ°€λ¥

### μ—λ¬ μΌ€μ΄μ¤
- `MAX_PLAYERS_EXCEEDED`: μµλ€ ν”λ μ΄μ–΄ μ μ΄κ³Ό
- `GAME_ALREADY_STARTED`: κ²μ„μ΄ μ΄λ―Έ μ‹μ‘λ¨ (`phase`κ°€ `"playing"` λλ” `"finished"`)
- `INVALID_DIFFICULTY`: μλ»λ λ‚μ΄λ„ κ°’
- `INVALID_COUNT`: AI ν”λ μ΄μ–΄ μκ°€ 0 μ΄ν•μ΄κ±°λ‚ μµλ€κ°’ μ΄κ³Ό

---

## π”§ ν”„λ΅ νΈμ—”λ“ κµ¬ν„ μƒνƒ

### β… μ΄λ―Έ κµ¬ν„λ μ‚¬ν•­
1. **λ°© μƒμ„± λ¨λ‹¬ UI**: AI ν”λ μ΄μ–΄ μ λ° λ‚μ΄λ„ μ„¤μ • κ°€λ¥
2. **λ©”μ‹μ§€ μ „μ†΅ κµ¬μ΅°**: `LobbyService`μ— `addAiPlayer` λ©”μ„λ“ μ¶”κ°€ μ¤€λΉ„ μ™„λ£
3. **AI ν”λ μ΄μ–΄ ν‘μ‹**: `PlayerCard`μ— `isBot` λ°°μ§€ ν‘μ‹ κµ¬ν„ μ™„λ£
4. **κ²μ„ μƒνƒ μ—…λ°μ΄νΈ μ²λ¦¬**: `GAME_STATE_UPDATE` λ©”μ‹μ§€μ—μ„ `isBot` ν•„λ“ νμ‹± μ¤€λΉ„ μ™„λ£

### π“ λ°±μ—”λ“ κµ¬ν„ ν•„μ” μ‚¬ν•­
1. `ADD_AI_PLAYER` λ©”μ‹μ§€ νƒ€μ… μ²λ¦¬
2. AI ν”λ μ΄μ–΄ μƒμ„± λ΅μ§
3. AI λ‚μ΄λ„λ³„ ν–‰λ™ ν¨ν„΄ (ν–¥ν›„ κ²μ„ μ§„ν–‰ μ‹)
4. `GAME_STATE_UPDATE`μ— `isBot` ν•„λ“ ν¬ν•¨
5. μ—λ¬ μ²λ¦¬ λ° κ²€μ¦ λ΅μ§

---

## π§ ν…μ¤νΈ μ‹λ‚λ¦¬μ¤

### 1. κΈ°λ³Έ AI ν”λ μ΄μ–΄ μ¶”κ°€
- **μ…λ ¥**: `ADD_AI_PLAYER` (count: 3, difficulty: medium)
- **μμƒ κ²°κ³Ό**: AI ν”λ μ΄μ–΄ 3λ… μ¶”κ°€, `GAME_STATE_UPDATE`μ— `isBot: true` ν¬ν•¨

### 2. μµλ€ ν”λ μ΄μ–΄ μ μ΄κ³Ό
- **μ…λ ¥**: ν„μ¬ 5λ…, `ADD_AI_PLAYER` (count: 3)
- **μμƒ κ²°κ³Ό**: μ—λ¬ λ©”μ‹μ§€ λ°ν™, AI ν”λ μ΄μ–΄ μ¶”κ°€ μ• λ¨

### 3. κ²μ„ μ‹μ‘ ν›„ AI μ¶”κ°€ μ‹λ„
- **μ…λ ¥**: `phase: "playing"` μƒνƒμ—μ„ `ADD_AI_PLAYER`
- **μμƒ κ²°κ³Ό**: μ—λ¬ λ©”μ‹μ§€ λ°ν™ (`GAME_ALREADY_STARTED`)

### 4. AI ν”λ μ΄μ–΄ μ‹λ³„ ν™•μΈ
- **μ…λ ¥**: `GAME_STATE_UPDATE` λ©”μ‹μ§€
- **μμƒ κ²°κ³Ό**: AI ν”λ μ΄μ–΄μ `isBot: true`, `name`μ— "AI_" μ ‘λ‘μ‚¬ λλ” κµ¬λ¶„ κ°€λ¥ν• μ΄λ¦„

---

## π“ μ¶”κ°€ κ³ λ ¤μ‚¬ν•­

### 1. AI ν”λ μ΄μ–΄ μ΄λ¦„ μƒμ„±
- **μ μ•**: `AI_Player_1`, `AI_Player_2` ν•μ‹ λλ” λ‚μ΄λ„ ν¬ν•¨ `AI_Easy_1`, `AI_Medium_1`
- **λλ”**: μ„λ²„μ—μ„ λλ¤ μ΄λ¦„ μƒμ„±

### 2. AI ν”λ μ΄μ–΄ μ κ±° κΈ°λ¥
- **μ°μ„ μμ„**: λ‚®μ (ν•„μ” μ‹ ν–¥ν›„ μ¶”κ°€)
- **μ©λ„**: μ‹¤μλ΅ μ¶”κ°€ν• AI ν”λ μ΄μ–΄ μ κ±°

### 3. AI λ‚μ΄λ„λ³„ μ°¨μ΄
- **Easy**: λ³΄μμ μΈ ν”λ μ΄, κ³µκ²© νν”Ό μ°μ„ 
- **Medium**: κ· ν•μ΅ν ν”λ μ΄
- **Hard**: κ³µκ²©μ  ν”λ μ΄, μµμ ν™”λ μ „λµ

### 4. λ°© μƒμ„± μ‹ μλ™ AI μ¶”κ°€
- **μ μ•**: URL μΏΌλ¦¬ νλΌλ―Έν„°λ„ μ§€μ› (ν•μ„ νΈν™μ„±)
  ```
  ws://localhost:8080/lobby/{gameId}?player={playerName}&ai_count=3&ai_difficulty=medium
  ```
- **μ¥μ **: λ°© μƒμ„±κ³Ό λ™μ‹μ— AI μ¶”κ°€ κ°€λ¥ (ν• λ²μ μ—°κ²°λ΅ μ²λ¦¬)

---

## π― κ¶μ¥ κµ¬ν„ μμ„

### Phase 1: κΈ°λ³Έ κΈ°λ¥ (ν•„μ)
1. `ADD_AI_PLAYER` λ©”μ‹μ§€ μ²λ¦¬
2. AI ν”λ μ΄μ–΄ μƒμ„± λ΅μ§
3. `GAME_STATE_UPDATE`μ— `isBot` ν•„λ“ ν¬ν•¨
4. κΈ°λ³Έ κ²€μ¦ λ΅μ§ (μµλ€ ν”λ μ΄μ–΄ μ, κ²μ„ μƒνƒ)

### Phase 2: ν–¥μƒλ κΈ°λ¥ (μ„ νƒ)
1. AI λ‚μ΄λ„λ³„ ν–‰λ™ ν¨ν„΄
2. AI ν”λ μ΄μ–΄ μ κ±° κΈ°λ¥
3. λ°© μƒμ„± μ‹ URL νλΌλ―Έν„° μ§€μ›

---

## π“ ν‘μ μ‚¬ν•­

1. **λ©”μ‹μ§€ ν•μ‹**: μ„ μ μ•ν• ν•μ‹μ΄ μ μ ν•κ°€μ”?
2. **μ—λ¬ μ½”λ“**: ν‘μ¤€ν™”λ μ—λ¬ μ½”λ“ μ²΄κ³„κ°€ μλ‚μ”?
3. **AI ν”λ μ΄μ–΄ μ΄λ¦„**: μ–΄λ–¤ ν•μ‹μΌλ΅ μƒμ„±ν• κΉμ”?
4. **λ‚μ΄λ„ κµ¬ν„**: AI λ‚μ΄λ„λ³„ μ°¨μ΄λ” μ–Έμ  κµ¬ν„ μμ •μΈκ°€μ”?
5. **URL νλΌλ―Έν„° μ§€μ›**: λ°© μƒμ„± μ‹ URL νλΌλ―Έν„°λ„ μ§€μ›ν•  μ μλ‚μ”?

---

## π“ μ°Έκ³  μλ£

- ν”„λ΅ νΈμ—”λ“ WebSocket νƒ€μ… μ •μ: `src/infrastructure/websocket/types.ts`
- ν”„λ΅ νΈμ—”λ“ LobbyService: `src/application/services/LobbyService.ts`
- λ°±μ—”λ“ μ—°λ™ μ¤€λΉ„ μ™„λ£ λ³΄κ³ μ„: `docs/BACKEND_COORDINATION.md`

---

**μ‘μ„±μ**: ν”„λ΅ νΈμ—”λ“ λ‹΄λ‹Ήμ  
**μµμΆ… μ—…λ°μ΄νΈ**: 2025-12-12

